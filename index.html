<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport"
			content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />
		<meta name="apple-mobile-web-app-capable" content="yes">
		<script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image.prod.js"></script>
		<script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
		<script>
			document.addEventListener("DOMContentLoaded", function () {
				const sceneEl = document.querySelector('a-scene');
				
				let arSystem;
				sceneEl.addEventListener('loaded', function () {
					arSystem = sceneEl.systems["mindar-image-system"];
				});

				// sceneEl
				// arReady event triggered when ready
				sceneEl.addEventListener("arReady", (event) => {
					console.log("MindAR is ready")
				});

				// arError event triggered when something went wrong. Mostly browser compatbility issue
				sceneEl.addEventListener("arError", (event) => {
					// console.log("MindAR failed to start")
				});

				//target
				const target = document.querySelector('#target');

				// detect target found
				target.addEventListener("targetFound", event => {
					console.log("target found");

					// Play Video
					let fuyuMemeVideo = document.querySelector('#fuyuMeme');

					fuyuMemeVideo.play();
				});

				// detect target lost
				target.addEventListener("targetLost", event => {
					console.log("target lost");

					// Pause Video
					let fuyuMemeVideo = document.querySelector('#fuyuMeme');

					fuyuMemeVideo.pause();
				});

				// detect click event
				target.addEventListener("click", event => {
					console.log("target clicked");

					let fuyuMemeVideo = document.querySelector('#fuyuMeme');

					if (fuyuMemeVideo.playing) {
						fuyuMemeVideo.pause();
					} else {
						fuyuMemeVideo.play();
					}
				});
			});
		</script>
	</head>

	<body>
		<a-scene
			mindar-image="imageTargetSrc: https://raw.githubusercontent.com/mike2005546/WebAR-Test/main/minds/fuyu.mind; uiScanning: no;"
			color-space="sRGB" renderer="colorManagement: true, physicallyCorrectLights" vr-mode-ui="enabled: false"
			device-orientation-permission-ui="enabled: false">
			<a-assets>
				<video id="fuyuMeme" loop="true" autoplay webkit-playsinline playsinline src="https://raw.githubusercontent.com/mike2005546/WebAR-Test/main/videos/FuyuMeme.webm" />
				<!--a-asset-item id="mintia"
					src="https://raw.githubusercontent.com/mike2005546/WebAR-Test/main/models/mintia/.gltf">
				</a-asset-item-->
			</a-assets>

			<a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

			<a-entity id="target" mindar-image-target="targetIndex: 0">
				<!--a-plane src="#memeTop" position="0 1 0" rotation="0 0 0"></a-plane-->
				<a-video src="#fuyuMeme" position="0 0 0.1" rotation="0 0 0" width="2.0" height="1.2"></a-video>
				<!--a-plane src="#memeRight" position="1 0 0" rotation="0 0 0"></a-plane-->
				<!--a-gltf-model rotation="0 0 0 " position="0 -1 0.1" scale="0.5 0.5 0.5" src="#mintia" animation-mixer-->
			</a-entity>
		</a-scene>
	</body>
</html>